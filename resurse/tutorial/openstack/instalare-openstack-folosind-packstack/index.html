<!DOCTYPE html> <html lang="ro"> <head> <title>Alexandru Coman | Instalare Openstack(RDO) folosind Packstack</title> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="author" content="Alexandru Coman"> <link rel="canonical" href="/resurse/tutorial/openstack/instalare-openstack-folosind-packstack/"> <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css"> <link href="/assets/css/main.css" rel="stylesheet" type="text/css"> <!-- Custom Fonts --> <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"> <link href="//fonts.googleapis.com/css?family=Montserrat:400,700,400italic,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"> <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --> <!-- WARNING: Respond.js doesn't work if you view the page via file:// --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]--> <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico"> <meta name="apple-mobile-web-app-capable" content="yes"> <link rel="apple-touch-icon" sizes="36x36" href="/img/web-app/icon-36p.png"> <link rel="apple-touch-icon" sizes="48x48" href="/img/web-app/icon-48p.png"> <link rel="apple-touch-icon" sizes="72x72" href="/img/web-app/icon-72p.png"> <link rel="apple-touch-icon" sizes="96x96" href="/img/web-app/icon-96p.png"> <link rel="apple-touch-icon" sizes="144x144" href="/img/web-app/icon-144p.png"> <link rel="apple-touch-icon" sizes="192x192" href="/img/web-app/icon-192p.png"> <link rel="manifest" href="/manifest.json"> <!-- Syntax highlight in post pages --> <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css"> </head> <body id="page-top"> <section id="post" class="post container content-section"> <div class="row"> <header id="post-header" class="text-center"> <h1>Instalare Openstack(RDO) folosind Packstack</h1> </header> <div class="terminal col-md-8 col-md-offset-2"> <p class="m-b-md"> <span class="text-muted">~ $ cd <a href="/resurse">resurse</a>/<a href="/resurse/tutorial">tutorial</a>/<a href="/resurse/tutorial/openstack">openstack</a></span><br> <span class="text-muted">~ $ cat Instalare Openstack(RDO) folosind Packstack</span> </p> </div> <article class="col-md-8 col-md-offset-2"> <div id="post-content" class="post-content text-justify"> <p>Acest tutorial vine în ajutorul studenților ce doresc să își pregătească o mașină virtuală care va contine un mediu de execuție OpensStack RDO(<a href="RDO">RedHat Deployment of OpenStack</a>)</p> <h2 id="resurse-necesare">Resurse necesare</h2> <p>Pentru pregătirea mașinei virtuale puteți urmari tutorialul despre <a href="/resurse/tutorial/virtualbox/2017/05/14/instalare-centos-7/">VirtualBox și Cent OS 7</a>. Două mențiune trebuie făcută:</p> <ul> <li>la pasul <strong>Specificații pentru mașina virtuală</strong> este indicat să aveți minim 6GB RAM.</li> <li>ISO-ul pe care il folosiți trebuie sa contină GUI(interfață grafică)</li> </ul> <p>Deoarece rețelele de tip <strong>NAT</strong> din <a href="https://www.virtualbox.org/">VirtualBox</a> sunt izolate(nu pot fi accesate din mașina gazdă) trebuie să facem port forwarding a portului 80 (cel pe care este expus <a href="https://wiki.openstack.org/wiki/Horizon">Horizon</a>, interfața web prin care se poate interacționa cu OpenStack). <strong>Atenție</strong> Acești pasi trebuie făcuți cat timp mașina este închisă!</p> <p>Pentru acest lucru accesăm <strong>Port Forwarding</strong> din meniul <strong>Settings</strong> &gt; <strong>Network</strong> și adăugam urmatoarele reguli: <img src="/assets/img/virtualbox/openstack/instalare-openstack-cu-packstack/0-port-forwarding.png" alt="Reguli de Port Forwarding" /></p> <h3 id="pasul-i-setarea-unui-ip-static">Pasul I. Setarea unui IP static</h3> <p>Deoarece <a href="http://www.openstack.org/">OpenStack</a> este compus din mai multe servicii (care pot rula pe masini diferite), fiecare serviciu se bazeaza pe cunoașterea IP-ului serviciilor cu care interacționeaza, dacă IP-ul s-ar schimba atunci nu s-ar mai putea realiza comunicarea corect.</p> <p>In CentOS pentru a seta un IP static putem modifica fișierul <code class="highlighter-rouge">/etc/sysconfig/network-scripts/ifcfg-enp0s3</code>(unde <code class="highlighter-rouge">enp0s3</code> este numele interfeței de tip <strong>NAT</strong>). In acest fișier trebuie adăugate urmatoarele opțiuni(pe langa cele existente):</p> <div class="language-vim highlighter-rouge"><pre class="highlight"><code>BOOTPROTO<span class="p">=</span><span class="s2">"static"</span>

IPADDR<span class="p">=</span><span class="m">10</span><span class="p">.</span><span class="m">0</span><span class="p">.</span><span class="m">2</span><span class="p">.</span><span class="m">200</span> # IP<span class="p">-</span>ul este ales <span class="k">de</span> noi<span class="p">,</span> trebuie doar <span class="k">sa</span> faca parte din sub<span class="p">-</span>reț<span class="k">ea</span>
NETMASK<span class="p">=</span><span class="m">255</span><span class="p">.</span><span class="m">255</span><span class="p">.</span><span class="m">255</span><span class="p">.</span><span class="m">0</span> 
GATEWAY<span class="p">=</span><span class="m">10</span><span class="p">.</span><span class="m">0</span><span class="p">.</span><span class="m">2</span><span class="p">.</span><span class="m">1</span>
DNS1<span class="p">=</span><span class="m">8</span><span class="p">.</span><span class="m">8</span><span class="p">.</span><span class="m">8</span><span class="p">.</span><span class="m">8</span>
DNS1<span class="p">=</span><span class="m">8</span><span class="p">.</span><span class="m">8</span><span class="p">.</span><span class="m">4</span><span class="p">.</span><span class="m">4</span>
</code></pre></div> <p><img src="/assets/img/virtualbox/openstack/instalare-openstack-cu-packstack/1-ip-static.png" alt="Setarea unui IP static" /></p> <h3 id="pasul-ii-pregatirea-rețelei">Pasul II. Pregatirea rețelei</h3> <p><strong>Atenție</strong>: acest pas va scădea securitatea sistemului de operare, această mașina nu trebuie să fie accesibilă din exterior. Dezactivăm și oprim firewall-ul (pentru a nu avea probleme cu port-urile folosite de OpenStack)</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo systemctl disable firewalld
<span class="gp">$ </span>sudo systemctl stop firewalld
</code></pre></div> <p>Dezactivăm și oprim NetworkManager (deoarece încă nu suportă bridging)</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo systemctl disable NetworkManager
<span class="gp">$ </span>sudo systemctl stop NetworkManager
</code></pre></div> <p>Activăm și pornim serviciul vechi de networking</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo systemctl <span class="nb">enable </span>network
<span class="gp">$ </span>sudo systemctl start network
</code></pre></div> <h3 id="pasul-iii-instalarea-pachetului-care-conține-utilitarul-de-instalare-și-a-utilitarului">Pasul III. Instalarea pachetului care conține utilitarul de instalare și a utilitarului</h3> <p>Instalăm pachetul care contine utilitarul</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo yum install -y centos-release-openstack-ocata
<span class="gp">$ </span>sudo yum update -y
</code></pre></div> <p>Unde <code class="highlighter-rouge">ocata</code> este ultima versiune de <a href="http://www.openstack.org/">OpenStack</a>.</p> <p>Instalăm ultilitarul care ne va ajuta să facem instalarea de <a href="http://www.openstack.org/">OpenStack</a>.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo yum install -y openstack-packstack
</code></pre></div> <h3 id="pasul-iv-instalam-openstack-folosind-packstack">Pasul IV. Instalam OpenStack folosind Packstack</h3> <p>Pentru a configura detaliile instalări <a href="https://www.rdoproject.org/install/quickstart/">Packstack</a> foloseste un fișier care poate fi generat folosind următoarea comandă:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>packstack --gen-answer-file<span class="o">=</span>answer.txt
</code></pre></div> <p>Rezultatul comenzi de mai sus este un fișier asemănător cu urmatoarea imagine: <img src="/assets/img/virtualbox/openstack/instalare-openstack-cu-packstack/4-answer-file.png" alt="Setarea unui IP static" /> In acest fișier o să dezactivăm anumite servicii de care nu avem nevoie:</p> <ul> <li><a href="https://wiki.openstack.org/wiki/Cinder">Cinder</a> proiectul care ofera Block Storage <div class="language-vim highlighter-rouge"><pre class="highlight"><code>  CONFIG_CINDER_INSTALL<span class="p">=</span><span class="k">n</span>
</code></pre></div> </li> <li><a href="https://wiki.openstack.org/wiki/Swift">Swift</a> proiectul care ofera Object Storage <div class="language-vim highlighter-rouge"><pre class="highlight"><code>  CONFIG_SWIFT_INSTALL<span class="p">=</span><span class="k">n</span>
</code></pre></div> </li> <li><a href="https://wiki.openstack.org/wiki/Telemetry#Ceilometer">Ceilometer</a> proiectul care permite colectarea de metrici despre Openstack <div class="language-vim highlighter-rouge"><pre class="highlight"><code>  CONFIG_CEILOMETER_INSTALL<span class="p">=</span><span class="k">n</span>
</code></pre></div> </li> <li><a href="https://wiki.openstack.org/wiki/Telemetry#Aodh">Aodh</a> proiectul care ofera setarea de alarme/notificari în OpenStack(se foloseste de <a href="https://wiki.openstack.org/wiki/Telemetry#Ceilometer">Ceilometer</a> pentru a notifica administratorul daca anumite metrici trec de un anumit prag) <div class="language-vim highlighter-rouge"><pre class="highlight"><code>  CONFIG_AODH_INSTALL<span class="p">=</span><span class="k">n</span>
</code></pre></div> </li> <li><a href="https://wiki.openstack.org/wiki/Telemetry#Gnocchi">Gnocchi</a> proiectul care permite stocarea de metrici cu o dimensiune foarte mare <div class="language-vim highlighter-rouge"><pre class="highlight"><code>  CONFIG_GNOCCHI_INSTALL<span class="p">=</span><span class="k">n</span>
</code></pre></div> <p>După personalizarea fișierului de configurare putem porni instalarea folosind comanda:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo packstack --answer-file<span class="o">=</span>answer.txt
</code></pre></div> <p>Acest proces durează aproximativ <strong>30 minute</strong>!</p> </li> </ul> <h3 id="pasul-v-finalizarea-instalării">Pasul V. Finalizarea instalării</h3> <p>După finalizarea instalări putem accesa <a href="https://wiki.openstack.org/wiki/Horizon">Horizon</a> la urmatoarea adresă <code class="highlighter-rouge">localhost:8080</code>. Credențialele pentru userul <code class="highlighter-rouge">admin</code> se află în fișierul <code class="highlighter-rouge">/root/keystonerc_admin</code> în variabila <code class="highlighter-rouge">OS_PASSWORD</code>.</p> <p><img src="/assets/img/virtualbox/openstack/instalare-openstack-cu-packstack/5-horizon.png" alt="Horizon-Dashboard" /></p> </div> <footer> <ul class="list-inline social-buttons"> </ul> </footer> </article> </div> </section> <footer id="footer" class="footer"> <div class="container text-center"> <p> Ultima actualizare: 28 mai 2017 <a itemprop="license" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"title="Conținut licențiat sub termenii Attribution-NonCommercial-ShareAlike 4.0 International">CC</a><br /> <a href="/" title="Spre situl Web al titularului laboratorului Alexandru Coman">Alexandru Coman</a> </p> </div> </footer> <script src="//code.jquery.com/jquery-1.11.3.min.js"></script> <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script> <script>hljs.initHighlightingOnLoad();</script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-99139394-1', 'auto'); ga('send', 'pageview'); </script> <script src="/assets/js/rrssb.min.js"></script> </body> </html>
